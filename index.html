<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>ì•„ì´íŒ¨ë“œ ë¯¸ë‹ˆ ì‹œê°„/ë‚ ì§œ/ë‚ ì”¨</title>
<style>
html, body {
  height:100%;
  margin:0;
  background:#0b0f14;
  color:#fff;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo",sans-serif;
  user-select:none;
}
.wrap {
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  overflow:hidden;
}
.panel {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  transition:opacity .8s ease, transform .8s ease;
  opacity:0;
  transform:scale(.98);
  pointer-events:none;
  text-align:center;
}
.panel.active {
  opacity:1;
  transform:scale(1);
  pointer-events:auto;
}
#panel-1 { font-size:10vw; font-weight:700; }
#panel-2 { font-size:8vw; font-weight:700; }
.date-line { font-size:6vw; font-weight:600; }
.weekday { font-size:5vw; font-weight:500; margin-top:2vw; }
.extra { font-size:4vw; font-weight:400; margin-top:1vw; color:#ffcc66; }
#panel-3 { font-size:5vw; }
.weather-icon { font-size:12vw; margin-bottom:2vw; }
.weather { font-size:5vw; line-height:1.4; white-space:pre-line; }
</style>
</head>
<body>
<div class="wrap" id="wrap">
  <div class="panel active" id="panel-1"><div id="clockDisplay">00:00</div></div>
  <div class="panel" id="panel-2">
    <div class="date-line" id="dateDisplay">10/03</div>
    <div class="weekday" id="weekdayDisplay">ê¸ˆìš”ì¼</div>
    <div class="extra" id="extraDisplay"></div>
  </div>
  <div class="panel" id="panel-3">
    <div class="weather-icon" id="weatherIcon">â˜€ï¸</div>
    <div class="weather" id="weatherDisplay">ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  </div>
</div>

<script>
(function(){
  const panels=[document.getElementById('panel-1'),document.getElementById('panel-2'),document.getElementById('panel-3')];
  let current=0;
  const INTERVAL_MS=20000;
  let timer=null;
  function show(i){ panels.forEach((p,idx)=>{ p.classList.toggle('active',idx===i); p.setAttribute('aria-hidden',String(idx!==i)); }); current=i; }
  function next(){ show((current+1)%panels.length); }
  function startTimer(){ stopTimer(); timer=setInterval(next,INTERVAL_MS); }
  function stopTimer(){ if(timer){ clearInterval(timer); timer=null; } }
  const wrap=document.getElementById('wrap');
  wrap.addEventListener('click',next);
  wrap.addEventListener('touchstart',next,{passive:true});
  show(0); startTimer();
  document.addEventListener('visibilitychange',()=>{ if(document.hidden) stopTimer(); else startTimer(); });

  // ì‹œê°„/ë‚ ì§œ
  const clockEl=document.getElementById('clockDisplay');
  const dateEl=document.getElementById('dateDisplay');
  const weekdayEl=document.getElementById('weekdayDisplay');
  const extraEl=document.getElementById('extraDisplay');
  function pad(n){ return n<10?'0'+n:n; }
  const weekdays=['ì¼ìš”ì¼','ì›”ìš”ì¼','í™”ìš”ì¼','ìˆ˜ìš”ì¼','ëª©ìš”ì¼','ê¸ˆìš”ì¼','í† ìš”ì¼'];
  function updateClock(){
    const now=new Date();
    let hh=now.getHours(); const mm=pad(now.getMinutes()); const ampm=hh>=12?'PM':'AM'; hh=hh%12; if(hh===0) hh=12;
    clockEl.textContent=`${hh}:${mm} ${ampm}`;
    const month=pad(now.getMonth()+1),day=pad(now.getDate());
    dateEl.textContent=`${month}/${day}`;
    const weekday=weekdays[now.getDay()];
    weekdayEl.textContent=weekday;
    extraEl.textContent=(weekday==='ì›”ìš”ì¼'||weekday==='ìˆ˜ìš”ì¼')?'ìš°ìœ ':'';
  }
  updateClock();
  setInterval(updateClock,1000);

  // ë‚ ì”¨
  const weatherEl=document.getElementById('weatherDisplay');
  const iconEl=document.getElementById('weatherIcon');
  const WEATHER_INTERVAL_MS=4*60*60*1000;
  let lastWeather=null;
  let lastWeatherTime=0;
  const weatherCodes={0:'â˜€ï¸ë§‘ìŒ',1:'ğŸŒ¤êµ¬ë¦„ ì¡°ê¸ˆ',2:'â›…ï¸êµ¬ë¦„ ë§ìŒ',3:'â˜ï¸íë¦¼',45:'ğŸŒ«ì•ˆê°œ',48:'ğŸŒ«ì•ˆê°œ',51:'ğŸŒ¦ì´ìŠ¬ë¹„',53:'ğŸŒ¦ì´ìŠ¬ë¹„',55:'ğŸŒ¦ì´ìŠ¬ë¹„',56:'ğŸŒ§ì–¼ìŒë¹„',57:'ğŸŒ§ì–¼ìŒë¹„',61:'ğŸŒ§ë¹„',63:'ğŸŒ§ë¹„',65:'ğŸŒ§ë¹„',66:'â„ï¸ì§„ëˆˆê¹¨ë¹„',67:'â„ï¸ì§„ëˆˆê¹¨ë¹„',71:'â„ï¸ëˆˆ',73:'â„ï¸ëˆˆ',75:'â„ï¸ëˆˆ',77:'â„ï¸ëˆˆ',80:'ğŸŒ§ì†Œë‚˜ê¸°',81:'ğŸŒ§ì†Œë‚˜ê¸°',82:'ğŸŒ§ì†Œë‚˜ê¸°',85:'â„ï¸ëˆˆ',86:'â„ï¸ëˆˆ',95:'â›ˆì²œë‘¥ë²ˆê°œ',96:'â›ˆì²œë‘¥ë²ˆê°œ',99:'â›ˆì²œë‘¥ë²ˆê°œ'};

  async function fetchWeather(){
    const now=Date.now();
    if(lastWeather && now - lastWeatherTime < WEATHER_INTERVAL_MS){
      updateWeatherDisplay(lastWeather);
      return;
    }
    try{
      const d=new Date();
      if(d.getHours()>=17) d.setDate(d.getDate()+1);
      const year=d.getFullYear(),month=d.getMonth()+1,day=d.getDate();
      const url=`https://api.open-meteo.com/v1/forecast?latitude=36.7833&longitude=127.0&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Asia/Seoul`;
      const res=await fetch(url);
      const data=await res.json();
      let index=data.daily.time.findIndex(t=>t===`${year}-${pad(month)}-${pad(day)}`);
      if(index===-1) index=0;
      lastWeather={
        weathercode:data.daily.weathercode[index],
        tempMax:data.daily.temperature_2m_max[index],
        tempMin:data.daily.temperature_2m_min[index]
      };
      lastWeatherTime=now;
      updateWeatherDisplay(lastWeather);
    }catch(e){
      weatherEl.textContent='ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
      iconEl.textContent='â“';
      console.error(e);
    }
  }

  function updateWeatherDisplay(obj){
    const code=obj.weathercode;
    const iconText=weatherCodes[code]||'â“';
    iconEl.textContent=iconText.slice(0,2);
    // ì¤„ë°”ê¿ˆ ì ìš©
    weatherEl.innerHTML=`${iconText.slice(2)}<br>ìµœê³ : ${obj.tempMax}Â°C<br>ìµœì €: ${obj.tempMin}Â°C`;
  }

  fetchWeather();
})();
</script>
</body>
</html>
